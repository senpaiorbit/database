<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Movie JSON Upload</title>
  <style>
    body { font-family: Arial; background:#0f172a; color:#e5e7eb; padding:20px }
    .box {
      border:2px dashed #38bdf8;
      padding:20px;
      text-align:center;
      margin-bottom:15px;
      cursor:pointer;
    }
    textarea {
      width:100%;
      height:260px;
      background:#020617;
      color:#e5e7eb;
      border:1px solid #334155;
      padding:10px;
    }
    button {
      padding:10px 20px;
      background:#22c55e;
      border:none;
      font-size:16px;
      cursor:pointer;
    }
    pre { background:#020617; padding:10px; margin-top:15px }
  </style>
</head>
<body>

<h2>ðŸ“¤ Upload Movies JSON</h2>

<div class="box" id="dropBox">
  Drag & Drop JSON file here  
  <br>or click to select
</div>

<input type="file" id="fileInput" accept=".json" hidden>

<textarea id="jsonInput" placeholder="Or paste JSON here..."></textarea>

<br><br>
<button onclick="upload()">Upload to Database</button>

<pre id="result">Status: idle</pre>

<script>
const dropBox = document.getElementById("dropBox");
const fileInput = document.getElementById("fileInput");
const jsonInput = document.getElementById("jsonInput");
const result = document.getElementById("result");

dropBox.onclick = () => fileInput.click();

dropBox.ondragover = e => { e.preventDefault(); };
dropBox.ondrop = e => {
  e.preventDefault();
  readFile(e.dataTransfer.files[0]);
};

fileInput.onchange = e => readFile(e.target.files[0]);

function readFile(file) {
  const reader = new FileReader();
  reader.onload = () => jsonInput.value = reader.result;
  reader.readAsText(file);
}

async function upload() {
  try {
    result.textContent = "Uploading...";
    const res = await fetch("/api/m_upload", {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: jsonInput.value
    });
    const data = await res.json();
    result.textContent = JSON.stringify(data, null, 2);
  } catch (err) {
    result.textContent = err.message;
  }
}
</script>

</body>
</html>
